import type { Meta, StoryObj } from '@storybook/react';
import VulnerabilityBreakdown from '../../components/VulnerabilityBreakdown';

const sampleData = {
  dependabot: [],
  codeScanning: [],
  secretScanning: [],
  totalCount: 12,
  severity: {
    critical: 2,
    high: 4,
    medium: 5,
    low: 1,
  },
  trend: {
    recentlyAdded: 3,
    recentlyClosed: 5,
    recentlyClosedDependabot: 2,
    recentlyClosedCodeScanning: 3,
    totalClosed: 15,
    addedBySeverity: {
      critical: 1,
      high: 1,
      medium: 1,
      low: 0,
    },
    closedBySeverity: {
      critical: 0,
      high: 2,
      medium: 2,
      low: 1,
    },
    deltaBySeverity: {
      critical: 1,
      high: -1,
      medium: -1,
      low: -1,
    },
  },
};

const meta = {
  title: 'Components/VulnerabilityBreakdown',
  component: VulnerabilityBreakdown,
  parameters: {
    layout: 'padded',
  },
  tags: ['autodocs'],
} satisfies Meta<typeof VulnerabilityBreakdown>;

export default meta;
type Story = StoryObj<typeof meta>;

export const Default: Story = {
  args: {
    data: sampleData,
  },
};

export const HighVulnerabilities: Story = {
  args: {
    data: {
      ...sampleData,
      totalCount: 25,
      severity: {
        critical: 8,
        high: 10,
        medium: 5,
        low: 2,
      },
    },
  },
};

export const LowVulnerabilities: Story = {
  args: {
    data: {
      ...sampleData,
      totalCount: 3,
      severity: {
        critical: 0,
        high: 0,
        medium: 2,
        low: 1,
      },
    },
  },
};
